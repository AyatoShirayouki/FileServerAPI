{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "81b92453",
   "metadata": {},
   "source": [
    "Author: Abdulrahman Altahhan, 2024.\n",
    "\n",
    "The notebook use a library of functionality in RL that aims for simplicity and general insight into how algorithms work, these libraries are written from scratch using standard python libraries (numpy, matplotlib etc.).\n",
    "Please note that you will need to take a permission from the author to use the code for research, commercially or otherwise."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "89ae6ef3",
   "metadata": {},
   "source": [
    "# Lesson 4- Dynamic Programming: Model-Based Approach\n",
    "\n",
    "**Learning outcomes**\n",
    "1. understand what we mean by the dynamics of the environment\n",
    "2. understand how the environment's dynamics are used in the Bellman equation\n",
    "3. use the dynamics to estimate the value function and the action-value function via dynamic programming \n",
    "4. understand the policy improvement theorem\n",
    "5. understand the policy-iteration and value-iteration algorithms as the backbone of many RL algorithms"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d5f1ca1",
   "metadata": {},
   "source": [
    "In the first lesson, you looked at a basic RL problem, the k-arm bandit, which involves only actions and no states (non-associative problem). In general, in RL, we are faced with different situations, and we need to take different actions in each situation in order to achieve a certain goal. This general type of environment with states and actions imposes a different flavour to the solution we can design. From now on, we will tackle associative problems. For associative problems, there are two approaches:\n",
    "\n",
    "1. Model-based approach\n",
    "2. Model-free approach\n",
    "\n",
    "In this lesson, we will take the first approach. We will learn how to use a model of the environment to solve an RL problem. The model is given in the form of the dynamics of the environment. These usually come in the form of 4 dimensions of conditional probability involving an answer to the following question: what is the probability of obtaining a certain reward r in a certain state s' given that the agent was previously in a state s and applied action a.\n",
    "\n",
    "We will assume that there is already a model for the environment and try to take advantage of this model to come up with the best policy. Nevertheless, we will see simple ways to build such models and come back to this question later when we tackle planning algorithms in RL."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9ff0ad52",
   "metadata": {},
   "source": [
    "**Reading**:\n",
    "The accompanying reading of this lesson are **chapters 3 and 4** from our textbook by Sutton and Barto available online [here](http://incompleteideas.net/book/RLbook2020.pdf).\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ba261a3",
   "metadata": {},
   "source": [
    "**Plan**\n",
    "As usual, in general there are two types of RL problems that we will attempt to design methods to deal with \n",
    "1. Prediction problem\n",
    "For These problems we will design Policy Evaluation Methods that attempt to find the best estimate for the value-function given a policy.\n",
    "\n",
    "\n",
    "2. Control problems \n",
    "For These problems we will design Value Iteration methods which utilise the idea of Generalised Policy Iteration. They attempt to find the best policy, via estimating an action-value function for a current policy then moving to a better and improved policy by choosing a greedy action often.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "0d124eec",
   "metadata": {},
   "outputs": [],
   "source": [
    "import nbimporter\n",
    "from Lesson3_MDPsGridWorld import * #Grid, randwalk, grid, cliffwalk, windy, cliffwalk, maze, maze8"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "25bbf258",
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a9dc74e3",
   "metadata": {},
   "source": [
    "We start by generating conditional probabilities from random joint probabilities, then we move into generating them from a model."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1df0b1e5",
   "metadata": {},
   "source": [
    "## 1D Probability\n",
    "Let us start by defining a 1D probability function "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0ca14d61",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.3922938  0.0207885  0.01603362 0.35837071 0.21251339] 1.0000000000000002\n"
     ]
    }
   ],
   "source": [
    "def P(nS):\n",
    "    p = np.zeros(nS)\n",
    "    for s in range(nS):\n",
    "        p[s] = rand()\n",
    "        \n",
    "    return p/p.sum()\n",
    "p = P(5)\n",
    "print(p, p.sum())\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "edcf017d",
   "metadata": {},
   "source": [
    "## 2D Probability: Joint Probability\n",
    "Let us move to defining a joint probability function "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a0a2f6e3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0.10270318 0.04195992]\n",
      " [0.06153184 0.17777312]\n",
      " [0.08602537 0.12958554]\n",
      " [0.09340004 0.06392181]\n",
      " [0.08128907 0.16181011]] 0.9999999999999999\n"
     ]
    }
   ],
   "source": [
    "def P(nS,nA):\n",
    "    p = np.zeros((nS,nA))\n",
    "    for s in range(nS):\n",
    "        for a in range(nA):\n",
    "            p[s,a] = rand()\n",
    "            \n",
    "        \n",
    "    # /p.sum() to make sure that this is a joint probability density, i.e. p.sum()==1\n",
    "    return p/p.sum() \n",
    "p = P(5,2)\n",
    "print(p, p.sum())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "571717df",
   "metadata": {},
   "source": [
    "Note that p[s,a] in the above is interpreted as the probability of being in state *s* and taking action *a* at the same time"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2f7f19e",
   "metadata": {},
   "source": [
    "## 2D Probability: Conditional Probability\n",
    "Let us move to defining a conditional probability function. Remember that a conditional probability must satisfy that Bayes rule.\n",
    "\n",
    "In the below pr[sn,a] is interpreted as pr[sn|a] the probability of moving to state sn given that we took action a "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "226157a8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0.09678666 0.2595462 ]\n",
      " [0.35421304 0.22036951]\n",
      " [0.09614007 0.23989015]\n",
      " [0.03580559 0.05081802]\n",
      " [0.41705465 0.22937612]]\n",
      "[1. 1.]\n"
     ]
    }
   ],
   "source": [
    "def P(nS,nA):\n",
    "    pr = np.zeros((nS,nA)) # joint\n",
    "    p  = np.zeros((nS,nA)) # conditional\n",
    "    \n",
    "    # first create a joint probability\n",
    "    for sn in range(nS):\n",
    "        for a in range(nA):\n",
    "            pr[sn,a] = rand()\n",
    "\n",
    "    # to make sure that this is a joint probability density\n",
    "    pr=pr/pr.sum() \n",
    "    \n",
    "    # now create a conditional probability via Bayes rule\n",
    "    for a in range(nA):\n",
    "        p[:,a] = pr[:,a]/pr[:,a].sum()\n",
    "            \n",
    "            \n",
    "    return p\n",
    "\n",
    "p = P(5,2)\n",
    "print(p)\n",
    "print(p.sum(0))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dd12f07d",
   "metadata": {},
   "source": [
    "## 4D Probability: Random Dynamic"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4fcc5adf",
   "metadata": {},
   "source": [
    "Our goal now is to be able to obtain a probability that can represent a random environment dynamics. Such a probability has the form of p[sn,rn | s,a] which represents the probability of moving to next state sn and obtaining the reward rn given that the agent was in state s and took action a.\n",
    "\n",
    "We generalise the above method of obtaining conditional probabilities from random joint probability density to 4-d. We have not dealt with 3-d cases for brevity. This time we will make it a bit more efficient by avoiding the four for loops and utilising the vectorised version of the rand() function in numpy and we convert to a conditional in-place to avoid having two probabilities p and pr."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "bb0143ef",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[[[0.26929885 0.30438198]\n",
      "   [0.02547514 0.20758572]\n",
      "   [0.26521477 0.01593715]]\n",
      "\n",
      "  [[0.13688973 0.23756712]\n",
      "   [0.25203987 0.25032872]\n",
      "   [0.17510866 0.01280092]]]\n",
      "\n",
      "\n",
      " [[[0.12436407 0.19494369]\n",
      "   [0.35512408 0.2413227 ]\n",
      "   [0.05953228 0.30388398]]\n",
      "\n",
      "  [[0.12211562 0.04634665]\n",
      "   [0.05960208 0.00148586]\n",
      "   [0.21376582 0.11416121]]]\n",
      "\n",
      "\n",
      " [[[0.17028449 0.05266434]\n",
      "   [0.17145641 0.11216295]\n",
      "   [0.01386517 0.26924033]]\n",
      "\n",
      "  [[0.17704724 0.16409623]\n",
      "   [0.13630242 0.18711405]\n",
      "   [0.2725133  0.28397642]]]]\n",
      "[[1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]]\n"
     ]
    }
   ],
   "source": [
    "def dynrand(nS, nA, nR): # states, actions, rewards dimensions \n",
    "    #first joint: p[sn,rn, s,a]\n",
    "    p  = np.random.rand(nS,nR,  nS,nA)\n",
    "    p /= p.sum()\n",
    "    \n",
    "    #convert it to conditional: p[sn,rn| s,a] \n",
    "    for s in range(nS):\n",
    "        for a in range(nA):\n",
    "            p[:,:, s,a] /= p[:,:, s,a].sum()\n",
    "        \n",
    "    return p\n",
    "\n",
    "p = dynrand(3,2,2)\n",
    "print(p)\n",
    "print(p.sum(0).sum(0))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "beed1b3f",
   "metadata": {},
   "source": [
    "## Inducing the dynamics by interacting with the environment"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0cd0fd6b",
   "metadata": {},
   "source": [
    "Now we move into obtaining the dynamics form an actual environment instead of generating the dynamics randomly as we did earlier.\n",
    "\n",
    "We will use mainly the random walk environment and the grid world environment and generate their dynamics. These are deterministic simple environments. Nevertheless, they are very useful to demonstrate the ideas of RL. \n",
    "\n",
    "Note that when we move to the real world the dynamics becomes much more complex and building or obtaining the dynamic becomes impractical form most cases. Therefore, towards that end instead of dealing directly with the environment dynamics we will see later how we can substitute this requirement by having to *interact* with the environment to gain *experience* which will help us *infer* a good *estimate* of the *expected* value function (discounted sum of rewards) which in turn will help us to *infer* a close to *optimal policy* for the task in hand. \n",
    "\n",
    "The exercise of dealing with probabilities and then using it in designing a Dynamic Programming solution is valuable since most of other solutions utilise the basic ideas (policy iteration, value iteration algorithms and policy improvements theorem) that we cover here and will mainly show us that we can devise a from of Bellman equation that is suitable for interaction instead of probabilities.\n",
    "\n",
    "Dynamic programming suffers from what Bellman described as the curse of dimensionality which basically dictates that the computational resources required to solve a problem grows exponentially with the dimensionality of the problem. So in our case the dimensionality is the number of states (as well as actions and rewards). So for example if the dynamic programming solution computational complexity is $2^{|S|}$ and the number of states $|S|=10$ then it costs $2^{10}=1024$ but when the number of states $|S|$ grows to 100 the cost become $2^{100}=1267650600228229401496703205376$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a5f18a93",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1024\n",
      "1267650600228229401496703205376\n"
     ]
    }
   ],
   "source": [
    "print(2**10)\n",
    "print(2**100)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "4e625ad3",
   "metadata": {},
   "outputs": [],
   "source": [
    "def dynamics(env=randwalk(), show=True, stoch=True, repeat=1000 ): #, maxjump=1\n",
    "    rewards = env.rewards_set()\n",
    "    nS, nA, nR = env.nS, env.nA, rewards.shape[0]\n",
    "    p  = np.zeros((nS,nR,  nS,nA))\n",
    "    \n",
    "    for i in range(repeat if not stoch else 1): # in case the env is stochastic (non-deterministic)\n",
    "        for s in range(nS):\n",
    "            for a in range(nA):\n",
    "                if not i and show: env.render() # render the first repitition only\n",
    "                env.s = s\n",
    "                sn,rn,_,_ = env.step(a)\n",
    "                rd = np.where(rewards==rn)[0][0] # get which reward index we need to update\n",
    "                #if (s!=sn) ^ (s in env.goals): p[sn,rd, s,a] +=1 # xor this would give terminal states a pr 1!\n",
    "                if (s!=sn) and not (s in env.goals): p[sn,rd, s,a] +=1\n",
    "            \n",
    "    # making sure that it is a conditional probability that satisfies Bayes rule\n",
    "    for s in range(nS):\n",
    "        for a in range(nA):\n",
    "            sm=p[:,:, s,a].sum()\n",
    "            if sm: p[:,:, s,a] /= sm\n",
    "            \n",
    "    return p"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2fb586cc",
   "metadata": {},
   "source": [
    "Note that states and actions can be immediately interpreted as indexes, rewards on the other hand are allowed to be real values. Therefore, we need to obtain the index of the reward value that we need to update since p[sn, rn, s,a] expects an index in rn."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "91915422",
   "metadata": {},
   "source": [
    "Let us now test our dynamics extraction procedure on a deterministic random walk environment:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "effed4b6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(7, 2, 7, 2)\n",
      "[[0. 0.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [0. 0.]]\n"
     ]
    }
   ],
   "source": [
    "p = dynamics(env=randwalk())\n",
    "print(p.shape)\n",
    "print(p.sum(0).sum(0))\n",
    "# print(p)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7422958c",
   "metadata": {},
   "source": [
    "The above shows that the probabilities of agent having been in state 0:6 (rows) and have gone left (column 0) all sum up to 1 except for the last terminal state 6 because once the agent is there it stays there and cannot move left. Also it shows equally that the probabilities of agent having been in state 0:6 and have gone right (column 1) all sum up to 1 except for the first terminal state 0 because once the agent is there it stays there and cannot move right. \n",
    "\n",
    "To further explain and dissect the generated probability dynamics we examine different states probabilities with different rewards."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c21dcd55",
   "metadata": {},
   "outputs": [],
   "source": [
    "def print_dynamcis(s):\n",
    "    print('-----------------------------Agent was in non-terminal state %d---------------------------------'%s)\n",
    "    print('Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state %d and moved left(0)]'%s)\n",
    "    print(p[:,0, s,0])\n",
    "\n",
    "    print('Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state %d and moved right(1)]'%s)\n",
    "    print(p[:,0, s,1])\n",
    "\n",
    "    print('Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state %d and moved left(0)]'%s)\n",
    "    print(p[:,1, s,0])\n",
    "\n",
    "    print('Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state %d and moved right(1)]'%s)\n",
    "    print(p[:,1, s,1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c54fdc8d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-----------------------------Agent was in non-terminal state 2---------------------------------\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 2 and moved left(0)]\n",
      "[0. 1. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 2 and moved right(1)]\n",
      "[0. 0. 0. 1. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 2 and moved left(0)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 2 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n"
     ]
    }
   ],
   "source": [
    "print_dynamcis(s=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "401489ee",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-----------------------------Agent was in non-terminal state 5---------------------------------\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 5 and moved left(0)]\n",
      "[0. 0. 0. 0. 1. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 5 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 5 and moved left(0)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 5 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 1.]\n"
     ]
    }
   ],
   "source": [
    "print_dynamcis(s=5)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eb72e4d1",
   "metadata": {},
   "source": [
    "Note that the probability of the penultimate state is a bit different than a mid-state such as 2. The reason is that when the agent move left it will get a 0 reward while when it moves right it will get a reward of 1."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "c9872032",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-----------------------------Agent was in non-terminal state 0---------------------------------\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 0 and moved left(0)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 0 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 0 and moved left(0)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 0 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n"
     ]
    }
   ],
   "source": [
    "print_dynamcis(s=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "cd68e839",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-----------------------------Agent was in non-terminal state 6---------------------------------\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 6 and moved left(0)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 0 |give agent was in state 6 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 6 and moved left(0)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n",
      "Pr[of moving to states 0:6 and obtaining reward 1 |give agent was in state 6 and moved right(1)]\n",
      "[0. 0. 0. 0. 0. 0. 0.]\n"
     ]
    }
   ],
   "source": [
    "print_dynamcis(s=6)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "48e0f514",
   "metadata": {},
   "source": [
    "Uncomment the xor relationship and see the effect on the resultant policy."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44f6069c",
   "metadata": {},
   "source": [
    "## Accommodating for jumps in the environment\n",
    "Some environments might allow the agent to jump over some obstacles or simply skip cells. For these we define a slightly altered dynamics to take the jumps into account. Below we show the definition."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "41091ef0",
   "metadata": {},
   "outputs": [],
   "source": [
    "def dynamics(env=randwalk(), show=True, stoch=False, repeat=1000): # , maxjump=1\n",
    "\n",
    "    rewards = env.rewards_set()\n",
    "    nS, nA, nR = env.nS, env.nA, rewards.shape[0]\n",
    "    p  = np.zeros((nS,nR,  nS,nA))\n",
    "    randjump = env.randjump\n",
    "    env.randjump = False # so that probability of all intermed. jumps is correctly calculated\n",
    "    for i in trange(repeat if stoch else 1): # in case the env is stochastic (non-deterministic)\n",
    "        for s in range(nS):\n",
    "            for a in range(nA):\n",
    "                for jump in (range(1,env.jump+1) if randjump else [env.jump]):\n",
    "                    if not i and show: env.render() # render the first repitition only\n",
    "                    env.s = s\n",
    "                    env.jump = jump\n",
    "                    rn = env.step(a)[1]\n",
    "                    sn = env.s\n",
    "                    rd = np.where(rewards==rn)[0][0] # get reward index we need to update\n",
    "                    # this would give terminal states a pr 1!\n",
    "                    # if (s!=sn) ^ (s in env.goals): p[sn,rd, s,a] +=1 # xor \n",
    "                    if (s!=sn) and not (s in env.goals): p[sn,rd, s,a] +=1\n",
    "    env.randjump = randjump\n",
    "    # making sure that it is a conditional probability that satisfies Bayes rule\n",
    "    for s in range(nS):\n",
    "        for a in range(nA):\n",
    "            sm=p[:,:, s,a].sum()\n",
    "            if sm: p[:,:, s,a] /= sm\n",
    "            \n",
    "    return p"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "30a6a1e4",
   "metadata": {},
   "source": [
    "### State-Transition probability: reward marginalisation"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ca847ac",
   "metadata": {},
   "source": [
    "Now that we have induced the dynamics from the *environment*, we are ready to infer the state-transition probability from the *dynamics*.  Note that many older papers of RL refer to the 3-d state-transition probability without referring to the 4-d dynamics. The state-transition probability p[sn | s,a] is a conditional probability that specifies the probability of moving to the next state sn given that the agent was in state s and applied action a regardless of the rewards. In other words, the state-transition probability does not refer to the reward altogether. Therefore, all we have to do to infer it from the dynamics is to marginalise the dynamics with respect to the reward, which is what the below code snippet is doing."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "599bc7c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# state-transition probability induced from the dynamics\n",
    "def ssa(p): \n",
    "    # states dim, action dim\n",
    "    nS, nA = p.shape[0], p.shape[3]\n",
    "    tr = np.zeros((nS, nS, nA))\n",
    "    for s in range(nS):\n",
    "        for a in range(nA):\n",
    "            for sn in range(nS):\n",
    "                tr[sn, s,a] = p[sn,:,s,a].sum()\n",
    "    return tr"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db076617",
   "metadata": {},
   "source": [
    "Let us now apply this function on the obtained random walk dynamics."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "410426fb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0. 0.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [1. 1.]\n",
      " [0. 0.]]\n"
     ]
    }
   ],
   "source": [
    "tr = ssa(p)\n",
    "print(tr.sum(0))\n",
    "# print(tr)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "87ccc979",
   "metadata": {},
   "source": [
    "Again the state-transition probability satisfies similar properties of the dynamics."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8e5cf7d8",
   "metadata": {},
   "source": [
    "Finally, we can apply a similar logic to obtain the reward function, see page 49 of the book."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "aa21b32d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# reward function induced from the dynamics\n",
    "def rsa(p, rewards):\n",
    "    # state dim, reward dim\n",
    "    nS, nA, nR = p.shape[0], p.shape[3], p.shape[1]\n",
    "    r = np.zeros((nS,nA))\n",
    "    for s in range(nS):\n",
    "        for a in range(nA):\n",
    "             for rn_, rn in enumerate(rewards): # get the reward rn and its index rn_\n",
    "                r[s,a] += rn*p[:,rn_, s,a].sum()\n",
    "    return r\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa1b321e",
   "metadata": {},
   "source": [
    "Note: that in the book authors use $r +\\gamma v(s)$ to mean the reward at time step $t+1$, in fact for consistency they should have used $r'$ instead as they do for $s'$. In our code treatment we have chosen to use $rn$ in place of $r'$."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "962c1763",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0. 0.]\n",
      " [0. 0.]\n",
      " [0. 0.]\n",
      " [0. 0.]\n",
      " [0. 0.]\n",
      " [0. 1.]\n",
      " [0. 0.]]\n"
     ]
    }
   ],
   "source": [
    "rewards = randwalk().rewards_set()\n",
    "r = rsa(p, rewards)\n",
    "print(r)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4043aaf5",
   "metadata": {},
   "source": [
    "This shows us that the expected reward of state-aciton pair (5,right)=1 and (6,right)=1. This is because we expect the agent to obtain a reward of 1 in the future when it move right while it was in state 5 because it will end up in the right terminal state which has a reward of 1. Also we have (6,right)=1 because once the agent is at the terminal state 6 it will stay there."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6dcf0ba4",
   "metadata": {},
   "source": [
    "# Dynamic Programming Methods"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "62b038b1",
   "metadata": {},
   "source": [
    "Ok so we are ready now to move to Dynamic programming algorithms to solve the RL problem of finding a best estimate of a value function and or finding an optimal policy."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "586865f3",
   "metadata": {},
   "source": [
    "## Policy evaluation"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4399b069",
   "metadata": {},
   "source": [
    "The first step to improving any policy is to evaluate how good or bad the policy is for the given task. This fundamental question can be addressed by tying up the task with a reward function that basically rewards the agent for achieving the task or a subtask that leads to the final goal. The agent's aim then becomes to collect as many rewards as possible (or to incur as few losses as possible), which should help the agent achieve the given task. One example is when a robot is moving in an environment, and we want it to reach a specific location, then we can reward/punish the robot for each step that is taking it close to the goal or away from it. But this awareness of the goal location is usually difficult to attain in real environments. Hence it is replaced by rewarding the agent when it reaches the goal or punishing the agent for each step taken without reaching the goal location.\n",
    "\n",
    "We can devise an evaluation strategy based on the discounted sum of rewards the agent is *expected* to collect while executing the task. The strategy depends on the dynamics of the environment. You may want to read section 4.1 and come back here to continue reading the code for the policy evaluation algorithm to get an insight into how it works."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "7227f313",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(1) # change the seed to get a different dynamics\n",
    "\n",
    "def Policy_evaluation(env=randwalk(), π=None, p=None, show=True, v0=.01, V0=None, θ=1e-3, γ=1, \n",
    "                      isrand=False, stoch=False): \n",
    "    nS, nA, nR = env.nS, env.nA, env.nR\n",
    "    \n",
    "    # m states, k actions and d rewards returns a 4-d dynamics\n",
    "    if isrand:      p = dynrand(nS, nA, nR);          rewards = [-1,1] \n",
    "    elif p is None: \n",
    "        p = dynamics(env=env, show=show, stoch=stoch)\n",
    "        rewards = env.rewards_set() # maxjump=maxjump\n",
    "    else:                                             \n",
    "        rewards = env.rewards_set() # obtain a model of the env\n",
    "        \n",
    "    #V = np.ones(nS )*v0; V[env.goals] = 0 \n",
    "    V = np.ones(nS )*v0 if V0 is None else V0.copy()\n",
    "    V[env.goals] = 0 \n",
    "\n",
    "    #if π is None: π = np.zeros((nS, nA), dtype=np.uint32); π[:,1]=1 \n",
    "    if π is None: π = np.ones(nS, dtype=np.uint32) # if π is not passed then always move right\n",
    "    i=0\n",
    "    # policy evaluation--------------------------------------------------------------\n",
    "    while True:\n",
    "        Δ = 0\n",
    "        i+= 1\n",
    "        # show indication to keep us infromed\n",
    "        if not show: clear_output(wait=True); rng = trange(nS) \n",
    "        else: rng = range(nS)\n",
    "        for s in rng:\n",
    "            v, V[s] = V[s], 0            \n",
    "            for sn in range(nS):\n",
    "                for rn_, rn in enumerate(rewards): # get the next reward rn and its index rn_\n",
    "                        if π.ndim == 1: # deterministic policy\n",
    "                            V[s] += p[sn,rn_, s,π[s]]*(rn + γ*V[sn])\n",
    "                        else:           # probabilistic policy \n",
    "                            V[s] += sum(π[s,a]*p[sn,rn_, s,a]*(rn + γ*V[sn]) for a in range(nA))\n",
    "            Δ = max(Δ, abs(v-V[s]))\n",
    "        if Δ<θ:\n",
    "            if show: print('policy evaluation stopped @ iteration %d:'%i)\n",
    "            break\n",
    "    \n",
    "    return V"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de89ea89",
   "metadata": {},
   "source": [
    "Note that we assume that when the policy is deterministic, it takes the shape (nS,) and its entries are actions ex. π[s]=1 means take right(1) when in state s.\n",
    "\n",
    "On the other hand if the policy is probabilistic, it has a shape of (nS, nA) and its entries are probabilities of each action given a state s, i.e π[a|s] written as π[s,a] in the code."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8989c74f",
   "metadata": {},
   "source": [
    "Note that γ must be < 1 to guarantee convergence of the Bellman equation because we do not know whether the policy guarantees reaching a terminal(goal) state. This condition can be relaxed when we move to sampling instead of dynamic programming in the next consequent lessons."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "71bf88bd",
   "metadata": {},
   "source": [
    "Ok, let us test our policy evaluation method on a default policy where the agent goes right always (embedded in the code)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "554b4f27",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:00<00:00,  1.07it/s]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 6:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([0., 1., 1., 1., 1., 1., 0.])"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Policy_evaluation()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae8c29f1",
   "metadata": {},
   "source": [
    "As we can see, the values for the default deterministic policy that always move the agent to the right produce a set of state values of 1 for the non-terminal states 1:5. This is what we expect since the accumulated return of this policy, given that γ=1, is 1 for these states since the agent is rewarded with 1 only when it reaches the far right terminal state, while when it is terminated at the far left state, it is rewarded with 0 (all other intermediate states also has a reward of 0)."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3aac185b",
   "metadata": {},
   "source": [
    "To further test our policy evaluation method, we will pass a different policy to it. This time we pass a simple probabilistic policy that gives left and right actions the same probability of 0.5. In this case, since γ=1, the expected analytical values of the intermediate states are given as 1/6, 2/6, 3/6, 4/6, 5/6, which represent the probabilities of ending up in the far right state given the agent has started in them (so pr(s=1)=1/6)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "6a78d74e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAWkAAAA6CAYAAAByFqijAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAPYQAAD2EBqD+naQAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAIIElEQVR4nO3dX0iVaQLH8e97PJZJR92I2qwIURPSpDJnoX9uTDh1UxeD7MXaeiFNTiRNgVEEXURFFpWxFZVEXcywdbHBXgxGwWlHwXAUci0hJqsLycLMglNmHj3vXrw500xqRz35Pq/8PhAnz/uH30v06+15n/Mcy7ZtGxERMZLP7QAiIjI8lbSIiMFU0iIiBlNJi4gYTCUtImIwlbSIiMFU0iIiBlNJi4gYzB/NTpFIhI6ODgKBAJZlfe5MIiKTnm3bhEIhUlNT8fmGv1+OqqQ7OjqYP39+zMKJiIijvb2defPmDbs9qpIOBAIAPH78mBkzZsQm2QQLh8PcuHGDwsJC4uPj3Y4zJroG93k9P+gaTNHd3U1aWtqv/TqcqEp6cIgjEAiQlJQ0/nQuCIfDJCYmkpSU5Nk/VF2D+7yeH3QNpgiHwwCfHELWg0MREYOppEVEDGZ0STc3N1NWVsaiRYtISkpiypQpzJkzh8LCQqqqqnjx4oXbEcVgPT09HD58mGXLljF9+nQSEhKYN28eq1evZu/evTx8+NDtiOIxbnRSVGPSEy0SibB7926OHz+O3+9nzZo1FBYWkpiYSGdnJ/X19ezcuZP9+/fz6NEjZs6c6XZkMUwoFGLVqlW0tLSQkZFBcXExKSkptLe309raypEjR0hPTyc9Pd3tqOIBbnaSkSW9b98+jh8/zvLly7ly5cqQf5EaGxvZvXs3vb29LiQU01VVVdHS0kJpaSnV1dUfPZx5/Pgx7969cymdeI2bnWRcST948IBjx44xa9Ysampqhv0XKT8/n2AwSCQSmeCE4gW3b98GYPv27UM+PU9LS5voSJOfbcOdO9DYCK2t8PYtTJsG2dmQnw9Ll4IHPwzndicZV9KXL19mYGCArVu3fvK/DJZlERcXN0HJxEsG5/O3tbWxZMkSl9NMcuEwVFdDVRU8eOAUsd/vlLZlQX+/8/vMTPjuO9iyBTw0bc7tTjLuweHgHdDatWtdTiJeVlRUBEBpaSl79uwhGAzy8uVLl1NNQvfuOXfJ27dDW5vznm07xd3f77wOfo1qW5uzX36+c5xHuN1Jxt1JP3v2DIDU1NSPtgWDQWpra3/33rp161i1atWEZBPv2LRpE0ePHuXAgQNUVlZSWVkJQHp6OuvXr2fHjh1kZma6nNLjfvqJ8i+/5N8DA3wN/HOEXfuAf9g2dUB5Swt7vvgCamqgoGBiso6D251kXEmP9OXlwWCQQ4cO/e69hIQElbQMqaKigrKyMq5fv059fT1NTU00NDRw5swZLl68yNWrV9m4caPbMb3p3j1uFRbyv4EBfgTKgf8Cfx1m9x+ACPAfoNi2+VtvL2kbNsDPP0NOzoREHiu3O8m44Y7Zs2cD8OTJk4+2HTx4ENu2sW2bS5cuTXQ08aBAIEBRUREnT56krq6O58+fs23bNnp7eyktLaWvr8/tiN4TDkNxMW/6+5kD5AJ/Bl6PcMgbYMH7fVOAN4NDIsXFzqvB3O4k40p6xYoVANy6dcvlJDIZJScnc/r0aRYsWEBXVxd37951O5L3VFdDSwtfRSI8BaYCncBXIxzyd+BHIBFIA3LAGbNuaXHOZzC3O8m4ki4pKcHn83HhwgW6urrcjiOTkGVZJCYmuh3Dm2zbmcUBxAO1wJP3ryPN1/gTcA/oAP71x42nTv32cNFAbneScSWdlZXFrl276OzsZMOGDcN+dPfVq1cTnEy85Pz58zQ2Ng657dq1a9y/f5+UlBRyDB8PNc6dO840uw9KdXaUh/qAWX9807bhl1+guTlGAWPP7U4y7sEhwJEjRwiHw5w6dYqsrCwKCgrIzc399SOYzc3NNDU1kZSURG5urttxxUA1NTWUlZWRkZHBypUrSU1N5fXr1zQ3N1NXV4fP5+Ps2bNMnTrV7aje0tjozH2O5Z2vZTnnXbo0dueMMTc7yciSjouLo6qqis2bN3Pu3Dlqa2tpaGigr6+PGTNmsHjxYk6cOMHmzZu1bocMqbKykpUrV3Lz5k1qa2t5+vQpAHPnzqWkpITy8nLy8vJcTulBra3OB1Vi+bDP73fOazA3O8nIkh6Ul5dHteEPFcRMWVlZVFRUUFFR4XaUyeXt2xHvon8Atn7wcw2w+lPntG3o6Rl/tgngRicZXdIiYphp00Zcf2Mj8JcPfp4bzTktC/Qgd1gqaRGJXna2M3VuGIH3v0alv985rwzJuNkdImKw/PzYT5ezbee8MiSVtIhEb+lSZzW7WC05almwcCFopcJhqaRFJHqW5Sw3Gks7dnhynemJopIWkdHZsgVyc2G86yb7/c55vvkmNrkmKZW0iIxOfDx8/z1MmQK+MVaIz/fbefyavzASlbSIjF5OjrMe9NSpoy9Zv985rqbG+GVKTaCSFpGxKShw1oPOznbGlD81rjy4T3a2c5wHFvw3gUpaRMYuJ8dZd+P0acjIcN6zLGcow+93XgfLOzPT2a+xUXfQo6DBIBEZn/h42LYNvv3WWc1u8NvCe3qcTxIOflv4kiWaxTEGKmkRiQ3LcuZRG7yanRdpuENExGAqaRERg6mkRUQMppIWETGYSlpExGBRze6w3y9N2N3d/VnDfE7hcJienh5evHhBfPxI32tsLl2D+7yeH3QNphjsU/sTS79GVdKhUAiAhQsXjjOWiIh8KBQKkZycPOx2y/5UjQORSISOjg4CgQCWJqOLiIybbduEQiFSU1PxjbBQVVQlLSIi7tCDQxERg6mkRUQMppIWETGYSlpExGAqaRERg6mkRUQMppIWETHY/wEPeShzprdZdwAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:01<00:00,  1.01s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 20:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([0.        , 0.16481679, 0.33055852, 0.49722519, 0.66458556,\n",
       "       0.83229278, 0.        ])"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "env = randwalk()\n",
    "π = np.ones((env.nS,env.nA))*.5 # probability of moving left and right are equal\n",
    "Policy_evaluation(env, π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "132fdb04",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.16666667, 0.33333333, 0.5       , 0.66666667, 0.83333333])"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.array([1/6, 2/6, 3/6, 4/6, 5/6])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e871807a",
   "metadata": {},
   "source": [
    "As we can see the values of this optimal policy (moving always right) progressively increase from left to right towards the goal that is most rewarding and the obtained values are exactly what we expected which is reassuring."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4796c21b",
   "metadata": {},
   "source": [
    "Let us try to evaluate a random policy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "f19cd40e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1 1 0 0 1 1 1]\n"
     ]
    }
   ],
   "source": [
    "env = randwalk()\n",
    "π = np.random.randint(env.nA, size=env.nS, dtype=np.uint32)\n",
    "print(π)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c71b0b9d",
   "metadata": {},
   "source": [
    "Now we call our policy evaluaiton subroutine."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "bdc781d0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:01<00:00,  1.01s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 3:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([0.  , 0.01, 0.01, 0.01, 1.  , 1.  , 0.  ])"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Policy_evaluation(env, π)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0d5b213b",
   "metadata": {},
   "source": [
    "As we can see the set of values are different than the above optimal policy and they are in harmony with the policy."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9bec294b",
   "metadata": {},
   "source": [
    "### Policy Evaluation for Grid world"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "36ba884b",
   "metadata": {},
   "source": [
    "Let us now try this on a slightly more complex env such as a grid world"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "a54887af",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:21<00:00, 21.97s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 7:\n",
      "[0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.\n",
      " 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.\n",
      " 0. 0. 0. 0. 0. 0.]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "env = maze()\n",
    "π = np.ones(env.nS, dtype=np.uint32)*3 # always go up\n",
    "V = Policy_evaluation(env=env, π=π)\n",
    "print(V)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "7b730964",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='V', V=V)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "368d34bd",
   "metadata": {},
   "source": [
    "As we can see moving up yeild some benefits mainly in the cells that lead to the goal."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2a79ff17",
   "metadata": {},
   "source": [
    "Let us now generate a random policy and evaluate it for a maze environment."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "2ee3a392",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1 3 0 0 1 0 3 1 0 2 1 2 0 2 1 2 0 3 0 2 0 1 2 2 0 3 3 1 1 3 2 0 2 1 1 1 3\n",
      " 3 1 2 1 1 0 0 1 0 0 1 3 3 2 1 0 2]\n"
     ]
    }
   ],
   "source": [
    "env = maze()\n",
    "π = np.random.randint(env.nA, size=env.nS, dtype=np.uint32)\n",
    "print(π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "a2f58faf",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='π', π=π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "830b5e74",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:22<00:00, 22.02s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 4:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,\n",
       "       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.  , 0.  , 0.01, 0.01, 0.01,\n",
       "       0.01, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.01, 0.01, 0.  ,\n",
       "       0.  , 0.  , 0.  , 0.  , 0.  , 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,\n",
       "       0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.01, 0.  , 0.  , 0.  ])"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Policy_evaluation(env, π)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0e7ff08e",
   "metadata": {},
   "source": [
    "As we can see, the randomly generated policy is chaotic and carry little value for the agent. However, evaluating different policies is highly important for an agent since it can guide the improvement of its adopted policy (based on this ability). One example is to keep evaluating random policies until some computational resources are consumed and pick the best. Below we show such a strategy of searching for an optimal policy. You can apply all other search algorithms that you have come across before in conventional AI (breadth-first etc.)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "4bc4235e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:22<00:00, 22.09s/it]\n"
     ]
    }
   ],
   "source": [
    "env = maze()\n",
    "Vmax= np.zeros((env.nS))\n",
    "p = dynamics(env)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "d8c38af6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "for _ in trange(200):\n",
    "    π = np.random.randint(env.nA, size=env.nS, dtype=np.uint32)\n",
    "    V = Policy_evaluation(env, π, p, False)\n",
    "    if Vmax.sum() < V.sum(): \n",
    "        Vmax = V\n",
    "        πmax = π\n",
    "\n",
    "env.render(underhood='π', π=πmax)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c56d3677",
   "metadata": {},
   "source": [
    "As we can see, finding the optimal policy by random search is difficult since the space of policies is huge, making exhaustive or random search infeasible (dimensionality problem). We need a way to take and maintain a step in the right direction of improving the policy. As you have already seen in another module, a greedy search can often lead to a good result. The next section shows a simple but effective strategy to gradually improve a policy by taking a greedy step towards the solution."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "64da4ba2",
   "metadata": {},
   "source": [
    "## Policy Iteration \n",
    "Now that we know how to evaluate a policy, it is time to improve it. Policy iteration is a basic and simple algorithm. It explicitly and iteratively tries first to reach a highly accurate estimate of the value function of the current policy, then it tries to improve the policy by maximising the probability of greedy actions as per the current value function. Evaluating the current policy fully and then improving it via policy iteration is inefficient, but it shows the fundamental ideas behind reinforcement learning. Please spend some time comprehending the code and reading the corresponding section 4.3 in the book."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "87d9afae",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(1) # change the seed to get a different dynamics\n",
    "\n",
    "def Policy_iteration(env=randwalk(), v0=.01, θ=1e-4, γ=.99, isrand=False): \n",
    "    nS, nA, nR = env.nS, env.nA, env.nR\n",
    "    \n",
    "    # m states, k actions and d rewards returns a 4-d dynamics\n",
    "    if isrand: p = dynrand(nS, nA, nR); rewards = [-1,1] \n",
    "    else:      p = dynamics(env);       rewards = env.rewards_set() # obtain a model of the env\n",
    "        \n",
    "    # 1. initialise arbitrarily -------------------------------------------------\n",
    "    V  = np.ones (nS )*v0; V[env.goals] = 0 \n",
    "    π  = np.zeros(nS, dtype=np.uint32) # policy for all states\n",
    "    Qs = np.zeros(nA) # action-values for individual state\n",
    "     \n",
    "    j=0\n",
    "    while True:\n",
    "        j+=1\n",
    "        # 2. policy evaluation---------------------------------------------------\n",
    "        i=0\n",
    "        while True:\n",
    "            Δ = 0\n",
    "            i+= 1\n",
    "            for s in range(nS):\n",
    "                v, V[s] = V[s], 0\n",
    "                for sn in range(nS):\n",
    "                    for rn_, rn in enumerate(rewards): # get the reward rn and its index rn_\n",
    "                        V[s] += p[sn,rn_,  s, π[s]]*(rn + γ*V[sn])\n",
    "                Δ = max(Δ, abs(v-V[s]))\n",
    "            if Δ<θ: print('policy evaluation stopped @ iteration %d:'%i); break\n",
    "\n",
    "        # 3. policy improvement----------------------------------------------------\n",
    "        policy_stable=True\n",
    "        for s in range(nS):\n",
    "            πs = π[s]\n",
    "            for a in range(nA):\n",
    "                Qs[a]=0\n",
    "                for sn in range(nS):\n",
    "                    for rn_, rn in enumerate(rewards): # get the reward rn and its index rn_\n",
    "                        Qs[a] += p[sn,rn_,  s,a]*(rn + γ*V[sn]) \n",
    "            π[s] = Qs.argmax() # greedy step\n",
    "            if π[s]!=πs: policy_stable=False\n",
    "        if policy_stable: print('policy improvement stopped @ iteration %d:'%j); break\n",
    "    return π"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a153808",
   "metadata": {},
   "source": [
    "We try our policy_iteration() funciton for a random dynamcis:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "41f3e392",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 7:\n",
      "policy evaluation stopped @ iteration 6:\n",
      "policy improvement stopped @ iteration 2:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([0, 1, 0, 0, 0, 0, 1], dtype=uint32)"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Policy_iteration(isrand=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "e80f9bd6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 6:\n",
      "policy evaluation stopped @ iteration 6:\n",
      "policy improvement stopped @ iteration 2:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([1, 1, 0, 0, 0, 1, 0], dtype=uint32)"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Policy_iteration(isrand=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5ee56795",
   "metadata": {},
   "source": [
    "We can of course try it for a proper Environments. We start by a random walk and then we move into grid world."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "59f54ef6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:01<00:00,  1.20s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy improvement stopped @ iteration 6:\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "env=randwalk()\n",
    "π = Policy_iteration(env)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "858564eb",
   "metadata": {},
   "source": [
    "To visualise the policy we would need to pass the environment explicitly and then render the environment."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "164c03cc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0 1 1 1 1 1 0]\n"
     ]
    }
   ],
   "source": [
    "print(π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "07724d47",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='π', π=π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "0baef785",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='π', π=π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "3737d08d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:22<00:00, 22.08s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy evaluation stopped @ iteration 2:\n",
      "policy improvement stopped @ iteration 16:\n"
     ]
    }
   ],
   "source": [
    "env=maze()\n",
    "π = Policy_iteration(env)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "5f37ad22",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='π', π=π)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ac88ba30",
   "metadata": {},
   "source": [
    "## Stochastic Policy Iteration\n",
    "We can also create a stochastic policy iteration method. It only differs from the deterministic policy iteration in two places (in the if ε_greedy statements): \n",
    "1. in the policy evaluation, we need to marginalize by multiplying by the action probability as we did earlier for the policy evaluation method\n",
    "2. In calculating the probability of taking an optimal action (to account for the stochastic non-determinism nature of the policy), we allow the agent to take random actions ε% of the time. \n",
    "\n",
    "We show the method below.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "ffdabb6e",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(1) # change the seed to get a different dynamics\n",
    "\n",
    "def Policy_iteration_stoch(env=randwalk(), v0=.01, θ=1e-4, γ=.99, ε=.1, isrand=False): \n",
    "    nS, nA, nR = env.nS, env.nA, env.nR\n",
    "    \n",
    "    # m states, k actions and d rewards returns a 4-d dynamics\n",
    "    if isrand: p = dynrand(nS, nA, nR); rewards = [-1,3] \n",
    "    else:      p = dynamics(env);       rewards = env.rewards_set() # obtain a model of the env\n",
    "        \n",
    "    # 1. initialise arbitrarily -------------------------------------------------\n",
    "    V  = np.ones (nS )*v0; V[env.goals] = 0 \n",
    "    π  = np.ones((nS, nA)) # probabilistic policy\n",
    "    for s in range(nS): π[s] /= π[s].sum()\n",
    "    Q  = np.ones((nS, nA))  # action-values for individual state\n",
    "\n",
    "    j=0\n",
    "    while True:\n",
    "        j+=1\n",
    "        # 2. policy evaluation---------------------------------------------------\n",
    "        i=0\n",
    "        while True:\n",
    "            Δ = 0\n",
    "            i+= 1\n",
    "            for s in range(nS):\n",
    "                v, V[s] = V[s], 0\n",
    "                for sn in range(nS):\n",
    "                    for rn_, rn in enumerate(rewards): # get the reward rn and its index rn_ \n",
    "                        # probabilistic policy\n",
    "                        V[s] += sum(π[s,a]*p[sn,rn_, s,a ]*(rn + γ*V[sn]) for a in range(nA)) \n",
    "                        \n",
    "                Δ = max(Δ, abs(v-V[s]))\n",
    "            if Δ<θ: print('policy evaluation stopped @ iteration %d:'%i); break\n",
    "\n",
    "        # 3. policy improvement----------------------------------------------------\n",
    "        policy_stable=True\n",
    "        for s in range(nS):\n",
    "            if s in env.goals: π[s]=0; continue\n",
    "            Qs = Q[s]\n",
    "            for a in range(nA):\n",
    "                Q[s,a]=0\n",
    "                for sn in range(nS):\n",
    "                    for rn_, rn in enumerate(rewards): # get the reward rn and its index rn_\n",
    "                        Q[s,a] += p[sn,rn_, s,a]*(rn + γ*V[sn])\n",
    "                        \n",
    "                if abs(Q[s,a]-Qs[a]) > 1e-4: policy_stable=False\n",
    "            π[s] = Qs*0 + ε/nA\n",
    "            π[s,Q[s].argmax()] += 1-ε     # greedy step  \n",
    "        if policy_stable: print('policy improvement stopped @ iteration %d:'%j); break\n",
    "\n",
    "    return π"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "badb2038",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 2500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:01<00:00,  1.04s/it]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "policy evaluation stopped @ iteration 27:\n",
      "policy improvement stopped @ iteration 1:\n",
      "[[0.   0.  ]\n",
      " [0.05 0.95]\n",
      " [0.05 0.95]\n",
      " [0.05 0.95]\n",
      " [0.05 0.95]\n",
      " [0.05 0.95]\n",
      " [0.   0.  ]]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "env=randwalk(figsize=[25,.5])\n",
    "π = Policy_iteration_stoch(env=env)\n",
    "print(π)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "e2b2acf8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 2500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='Q', Q=π)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b7efb676",
   "metadata": {},
   "source": [
    "As we can see the policy chooses to take right majority of the times  1-ε+ ε/nA=.95 while taking left occasionally  ε/nA."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eb6bc2db",
   "metadata": {},
   "source": [
    "## Value Iteration Algorithm"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "28c46f87",
   "metadata": {},
   "source": [
    "Our final step to fully develop the ideas of dynamic programming is to shorten the time it takes for a policy to be evaluated and improved. One simple idea we will follow here is to slightly improve the evaluation and immediately improve the policy. We do these two steps iteratively until our policy has stopped to improve. This is a very effective strategy because we do not wait until the policy is fully evaluated to improve it; we weave and interleave the two loops together in one loop. Below we show this algorithm. Read section 4.4 to further your understanding of this algorithm."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "d32f9fa9",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(1) # change the seed to get a different dynamics\n",
    "\n",
    "def π(Q):\n",
    "    return [Q[s].argmax() for s in range(Q.shape[0])]\n",
    "\n",
    "def value_iteration(env=randwalk(), v0=.01, θ=1e-4, γ=.99, isrand=False, show=False): \n",
    "    # initialise V randomly but make sure that terminal states = 0\n",
    "    nS, nA, nR, i = env.nS, env.nA, env.nR, 0\n",
    "    V = np.ones( nS    )*v0; V[env.goals] = 0 \n",
    "    Q = np.ones((nS,nA))*v0; Q[env.goals] = 0 \n",
    "\n",
    "    # p is a 4-d dynamics\n",
    "    if isrand: p = dynrand(nS, nA, nR); rewards = [-1,1] \n",
    "    else:      p = dynamics(env, show); rewards =  env.rewards_set()\n",
    "    \n",
    "    while True:\n",
    "        Δ = 0\n",
    "        i+= 1\n",
    "        for s in range(nS):\n",
    "            v, Q[s] = V[s], 0\n",
    "            for a in range(nA):\n",
    "                for sn in range(nS):\n",
    "                    for rn_, rn in enumerate(rewards): # get the reward rn and its index rn_\n",
    "                        Q[s,a] += p[sn,rn_,  s,a]*(rn + γ*V[sn])  # max operation is embedded now in the evaluation\n",
    "            V[s] = Q[s].max()                                    # step which made the algorithm more concise \n",
    "            Δ = max(Δ, abs(v-V[s]))\n",
    "            \n",
    "        if Δ<θ: print('loop stopped @ iteration: %d , Δ = %2.f'% (i, Δ)); break\n",
    "    return Q"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "4688661d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:00<00:00, 4788.02it/s]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "loop stopped @ iteration: 6 , Δ =  0\n",
      "optimal action for state [0, 1, 1, 1, 1, 1, 0]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "env = randwalk()\n",
    "policy = π(value_iteration(env))\n",
    "print('optimal action for state', policy)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "5af1268c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1500x50 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='π', π=policy)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "730b962a",
   "metadata": {},
   "source": [
    "As we can see our value iteration algorithm is effective in finding the optimal policy. Note that for the random walk environment the best policy is to move right to get a reward."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "78362bf8",
   "metadata": {},
   "source": [
    "### Value Iteration on a Grid World"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "abe4dba3",
   "metadata": {},
   "source": [
    "Now that you understand the value-iteration algorithm, you can apply it on a different and more complex envornment such as the grid world. As we did for the random walk, you have access to a grid world via the Grid class and its subroutines."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "585210ad",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|██████████| 1/1 [00:00<00:00, 497.49it/s]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "loop stopped @ iteration: 10 , Δ =  0\n",
      "optimal action for state [1, 1, 1, 1, 1, 1, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 0, 0, 0]\n"
     ]
    }
   ],
   "source": [
    "env=grid()\n",
    "policy = π(value_iteration(env))\n",
    "print('optimal action for state', policy)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8572e080",
   "metadata": {},
   "source": [
    "To interpret the policy we provided you with a useful funciton to rebder the environemt with its policy, we show that below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "bed3a519",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env.render(underhood='π', π=policy)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7b22a652",
   "metadata": {},
   "source": [
    "As we can see the policy-iteration algorithm successfuly gave us the best policy for this simple environment."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d551da9b",
   "metadata": {},
   "source": [
    "### Value Iteration on a Windy Grid World\n",
    "Below we show the results of applying the value iteration method on a windy grid world. This is almost identical to the previous simple grid world without any obstacles, the only difference is that there is a wind blowing upwards, which shifts the agent 2 or 1 cell depending on its location. See page 130 of the book."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "8f4feb7e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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TaLpmk3XXHTzWL58Od5991387Gc/Q25urt1xvqZrLp3ovPxQuubin3fs+vXrN1z3xRdfdLhNoumaTddcdHP453/+Z/zud7/DI488gtWrV9sd52u65tKNzssPpc3ltttuAxB8NSzU6lsi6JpN11zU+1VUVODnP/85/uEf/gGbN2/WZmonXXPpSOflh9LmMnXqVADAO++8c8N177zzDtLT03HnnXeqfMiw6ZpN11zUu1VWVqKyshILFy7E1q1bQ84RlUi65tKV1ssPlfs1X7p0yUxLS+tyn+sf/OAHKh+uV2TTNVcwOu3f3xmzha+ystIEYH7/+983W1tb7Y7zNV1zdabT+6nz8iO5oqKiQlWjSktLQ3p6OrZu3Yo333wTPp8Pf/zjH/HYY49hwIAB2LlzJwYMGKDq4XpFNl1z+f3+97/H7t278fbbb+Ott95Cc3MzWltb8fbbb+P48eO45557mK0HZfvtb3+LlStXYvjw4XjkkUfwwQcf4Pjx419famtrMWrUKObqRNf3U+vlRzw61o4dO8xJkyaZKSkpZlZWlvnd737XPHPmTDweKmK6ZtM11+zZs00AQS92f3tjtsgtWrSoy1wAzNmzZzNXELq+n346Lj845T4RESnHrWVERKQcmwsRESnH5kJERMqxuRARkXJsLkREpBybCxERKcfmQkREyrG5EBGRcmwuRESkHJsLEREpx+ZCRETKsbkQEZFy/x8fTQ1GoeZi4QAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env=windy()\n",
    "policy = π(value_iteration(env))\n",
    "print('optimal action for state', policy)\n",
    "env.render(underhood='π', π=policy)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "55d4220a",
   "metadata": {},
   "source": [
    "### value iteration on a maze\n",
    "Let us now apply the policy-iteration on the maze env."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "794028d7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 1700x300 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "env=maze()\n",
    "policy = π(value_iteration(env))\n",
    "print('optimal action for state', policy)\n",
    "env.render(underhood='π', π=policy)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da4463cf",
   "metadata": {},
   "source": [
    "## Conclusion\n",
    "In this lesson, we covered the main dynamic programming algorithms. We saw how evaluating a policy was extremely useful in being the key component to allowing us to improve the policy. We then developed a policy iteration algorithm which improves the policy in two main steps:\n",
    "1. a step that evaluates the policy fully to reach an accurate estimation of the action values of the current policy\n",
    "2. a step that improves the policy by adopting a greedy action. The usage of an action-value function Q(s,a) was key in allowing us to choose between actions since the state-value function V(s) does not differentiate between the values of actions\n",
    "\n",
    "We finally saw how the value-iteration algorithm has a similar structure to the policy-iteration algorithm with one important difference; it can arrive at an optimal policy by just taking a step *towards* the optimal policy by slightly refines its estimation of the action-value function without fully evaluating it.  Hence, it improves its policy more concisely and with much less overhead than the full policy iteration method.\n",
    "\n",
    "In the next lesson, we will take a different approach and move to cover sampling methods that do not use the dynamics of the environment explicitly and instead try to improve its policy by interacting with the environment.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ef3383f3",
   "metadata": {},
   "source": [
    "## Your turn\n",
    "Try the policy iteration on the maze8 which allows the agent to move diagonally, it is fun."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cc2bef3e",
   "metadata": {},
   "source": [
    "You should arrive to an optimal policy for this maze environment where agent can move diagonally and has 8 actions. You should be able to observe how efficient the policy is and how the agent is able to reach the goal location from anywhere in the environment.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4348c6aa",
   "metadata": {},
   "source": [
    "## Challenges\n",
    "1. Alter policy_iteration_stoch to use a softmax policy instead of the ε-greedy policy that we used in the policy_iteration_stoch method.\n",
    "2. You can challenge yourself also by trying to combine policy_iteration and policy_iteration_stoch() in one method. Use a flag such as ε_greedy to distinguish between deterministic and probabilistic policies."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a8f31744-a30b-4cf8-8bde-ad14171ea5b4",
   "metadata": {},
   "source": [
    "[Back to TOC](IntroductionTOC.ipynb)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
